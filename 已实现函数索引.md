# Empyrical å·²å®ç°å‡½æ•°å®Œæ•´ç´¢å¼•

**æ›´æ–°æ—¥æœŸï¼š** 2025-01-11  
**ç‰ˆæœ¬ï¼š** v0.6.0  
**æ€»å‡½æ•°æ•°ï¼š** 52+

---

## ğŸ“‘ ç›®å½•

- [æ”¶ç›ŠæŒ‡æ ‡](#æ”¶ç›ŠæŒ‡æ ‡)
- [é£é™©è°ƒæ•´æ”¶ç›ŠæŒ‡æ ‡](#é£é™©è°ƒæ•´æ”¶ç›ŠæŒ‡æ ‡)
- [é£é™©æŒ‡æ ‡](#é£é™©æŒ‡æ ‡)
- [å›æ’¤åˆ†æ](#å›æ’¤åˆ†æ)
- [ç»Ÿè®¡ç‰¹æ€§](#ç»Ÿè®¡ç‰¹æ€§)
- [ç›¸å…³æ€§åˆ†æ](#ç›¸å…³æ€§åˆ†æ)
- [è¿ç»­æ¶¨è·Œç»Ÿè®¡](#è¿ç»­æ¶¨è·Œç»Ÿè®¡)
- [å¹´åº¦æŒ‡æ ‡](#å¹´åº¦æŒ‡æ ‡)
- [å¸‚åœºå…³ç³»](#å¸‚åœºå…³ç³»)

---

## æ”¶ç›ŠæŒ‡æ ‡

### `cum_returns(returns, starting_value=0)`
è®¡ç®—ç´¯è®¡æ”¶ç›Š

### `cum_returns_final(returns, starting_value=0)`
è®¡ç®—æœ€ç»ˆç´¯è®¡æ”¶ç›Š

### `aggregate_returns(returns, convert_to)`
èšåˆæ”¶ç›Šåˆ°ä¸åŒæ—¶é—´å‘¨æœŸ

### `annual_return(returns, period=DAILY, annualization=None)`
è®¡ç®—å¹´åŒ–æ”¶ç›Šç‡

### `cagr(returns, period=DAILY, annualization=None)`
è®¡ç®—å¤åˆå¹´å¢é•¿ç‡ï¼ˆç­‰åŒäºå¹´åŒ–æ”¶ç›Šï¼‰

### `annual_return_by_year(returns, period=DAILY, annualization=None)`
è®¡ç®—æ¯å¹´çš„å¹´åŒ–æ”¶ç›Šç‡

### `annual_active_return(returns, factor_returns, period=DAILY, annualization=None)`
è®¡ç®—å¹´åŒ–ä¸»åŠ¨æ”¶ç›Šï¼ˆç›¸å¯¹åŸºå‡†ï¼‰

---

## é£é™©è°ƒæ•´æ”¶ç›ŠæŒ‡æ ‡

### `sharpe_ratio(returns, risk_free=0.0, period=DAILY, annualization=None)`
è®¡ç®—å¤æ™®æ¯”ç‡

### `sharpe_ratio_by_year(returns, risk_free=0.0, period=DAILY, annualization=None)`
è®¡ç®—æ¯å¹´çš„å¤æ™®æ¯”ç‡

### `sortino_ratio(returns, required_return=0.0, period=DAILY, annualization=None)`
è®¡ç®—ç´¢æè¯ºæ¯”ç‡ï¼ˆä½¿ç”¨ä¸‹è¡Œé£é™©ï¼‰

### `calmar_ratio(returns, period=DAILY, annualization=None)`
è®¡ç®—å¡ç›æ¯”ç‡ï¼ˆå¹´åŒ–æ”¶ç›Š/æœ€å¤§å›æ’¤ï¼‰

### `omega_ratio(returns, risk_free=0.0, required_return=0.0)`
è®¡ç®—Omegaæ¯”ç‡

### `information_ratio(returns, factor_returns, period=DAILY, annualization=None)`
è®¡ç®—ä¿¡æ¯æ¯”ç‡

### `information_ratio_by_year(returns, factor_returns, period=DAILY, annualization=None)`
è®¡ç®—æ¯å¹´çš„ä¿¡æ¯æ¯”ç‡

### `treynor_ratio(returns, factor_returns, risk_free=0.0, period=DAILY, annualization=None)`
è®¡ç®—ç‰¹é›·è¯ºæ¯”ç‡ï¼ˆæ”¶ç›Š/Betaï¼‰

### `m_squared(returns, factor_returns, risk_free=0.0, period=DAILY, annualization=None)`
è®¡ç®—Må¹³æ–¹æŒ‡æ ‡ï¼ˆModigliani-Modigliani measureï¼‰

### `sterling_ratio(returns, risk_free=0.0, period=DAILY, annualization=None)` â­æ–°å¢
è®¡ç®—æ–¯ç‰¹æ—æ¯”ç‡ï¼ˆä½¿ç”¨å¹³å‡å›æ’¤ï¼‰

### `burke_ratio(returns, risk_free=0.0, period=DAILY, annualization=None)` â­æ–°å¢
è®¡ç®—Burkeæ¯”ç‡ï¼ˆä½¿ç”¨å›æ’¤å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ï¼‰

### `kappa_three_ratio(returns, risk_free=0.0, period=DAILY, annualization=None, mar=0.0)` â­æ–°å¢
è®¡ç®—Kappa 3æ¯”ç‡ï¼ˆä½¿ç”¨ä¸‰é˜¶ä¸‹åçŸ©ï¼‰

### `adjusted_sharpe_ratio(returns, risk_free=0.0, period=DAILY, annualization=None)` â­æ–°å¢
è®¡ç®—è°ƒæ•´å¤æ™®æ¯”ç‡ï¼ˆè€ƒè™‘ååº¦å’Œå³°åº¦ï¼‰

### `stutzer_index(returns, risk_free=0.0, target_return=0.0)` â­æ–°å¢
è®¡ç®—StutzeræŒ‡æ•°ï¼ˆä¿¡æ¯è®ºé£é™©æµ‹åº¦ï¼‰

---

## é£é™©æŒ‡æ ‡

### `annual_volatility(returns, period=DAILY, annualization=None)`
è®¡ç®—å¹´åŒ–æ³¢åŠ¨ç‡

### `annual_volatility_by_year(returns, period=DAILY, annualization=None)`
è®¡ç®—æ¯å¹´çš„å¹´åŒ–æ³¢åŠ¨ç‡

### `downside_risk(returns, required_return=0.0, period=DAILY, annualization=None)`
è®¡ç®—ä¸‹è¡Œé£é™©

### `tracking_error(returns, factor_returns, period=DAILY, annualization=None)`
è®¡ç®—è·Ÿè¸ªè¯¯å·®

### `annual_active_risk(returns, factor_returns, period=DAILY, annualization=None)`
è®¡ç®—å¹´åŒ–ä¸»åŠ¨é£é™©

### `tracking_difference(returns, factor_returns)`
è®¡ç®—è·Ÿè¸ªåç¦»åº¦

### `residual_risk(returns, factor_returns)` â­æ–°å¢
è®¡ç®—æ®‹å·®é£é™©ï¼ˆä¸å¯åˆ†æ•£é£é™©ï¼‰

---

## å›æ’¤åˆ†æ

### `max_drawdown(returns)`
è®¡ç®—æœ€å¤§å›æ’¤

### `max_drawdown_by_year(returns)`
è®¡ç®—æ¯å¹´çš„æœ€å¤§å›æ’¤

### `max_drawdown_days(returns)`
è®¡ç®—æœ€å¤§å›æ’¤æŒç»­å¤©æ•°

### `max_drawdown_weeks(returns)`
è®¡ç®—æœ€å¤§å›æ’¤æŒç»­å‘¨æ•°

### `max_drawdown_months(returns)`
è®¡ç®—æœ€å¤§å›æ’¤æŒç»­æœˆæ•°

### `max_drawdown_recovery_days(returns)`
è®¡ç®—æœ€å¤§å›æ’¤ä¿®å¤å¤©æ•°

### `max_drawdown_recovery_weeks(returns)`
è®¡ç®—æœ€å¤§å›æ’¤ä¿®å¤å‘¨æ•°

### `max_drawdown_recovery_months(returns)`
è®¡ç®—æœ€å¤§å›æ’¤ä¿®å¤æœˆæ•°

### `second_max_drawdown(returns)`
è®¡ç®—ç¬¬äºŒå¤§å›æ’¤

### `second_max_drawdown_days(returns)` â­æ–°å¢
è®¡ç®—ç¬¬äºŒå¤§å›æ’¤æŒç»­å¤©æ•°

### `second_max_drawdown_recovery_days(returns)` â­æ–°å¢
è®¡ç®—ç¬¬äºŒå¤§å›æ’¤ä¿®å¤å¤©æ•°

### `third_max_drawdown(returns)`
è®¡ç®—ç¬¬ä¸‰å¤§å›æ’¤

### `third_max_drawdown_days(returns)` â­æ–°å¢
è®¡ç®—ç¬¬ä¸‰å¤§å›æ’¤æŒç»­å¤©æ•°

### `third_max_drawdown_recovery_days(returns)` â­æ–°å¢
è®¡ç®—ç¬¬ä¸‰å¤§å›æ’¤ä¿®å¤å¤©æ•°

### `get_max_drawdown_period(returns)`
è·å–æœ€å¤§å›æ’¤çš„èµ·æ­¢æ—¥æœŸ

---

## ç»Ÿè®¡ç‰¹æ€§

### `skewness(returns)` â­æ–°å¢
è®¡ç®—æ”¶ç›Šåˆ†å¸ƒçš„ååº¦

### `kurtosis(returns)` â­æ–°å¢
è®¡ç®—æ”¶ç›Šåˆ†å¸ƒçš„å³°åº¦

### `hurst_exponent(returns)` â­æ–°å¢
è®¡ç®—èµ«æ–¯ç‰¹æŒ‡æ•°ï¼ˆé•¿æœŸè®°å¿†æ€§ï¼‰

### `tail_ratio(returns)`
è®¡ç®—å°¾éƒ¨æ¯”ç‡

### `value_at_risk(returns, cutoff=0.05)`
è®¡ç®—åœ¨é™©ä»·å€¼ï¼ˆVaRï¼‰

### `conditional_value_at_risk(returns, cutoff=0.05)`
è®¡ç®—æ¡ä»¶åœ¨é™©ä»·å€¼ï¼ˆCVaRï¼‰

---

## ç›¸å…³æ€§åˆ†æ

### `stock_market_correlation(returns, stock_market_returns)` â­æ–°å¢
è®¡ç®—ä¸è‚¡å¸‚çš„ç›¸å…³æ€§

### `bond_market_correlation(returns, bond_market_returns)` â­æ–°å¢
è®¡ç®—ä¸å€ºå¸‚çš„ç›¸å…³æ€§

### `futures_market_correlation(returns, futures_market_returns)` â­æ–°å¢
è®¡ç®—ä¸æœŸå¸‚çš„ç›¸å…³æ€§

### `serial_correlation(returns, lag=1)` â­æ–°å¢
è®¡ç®—åºåˆ—ç›¸å…³æ€§ï¼ˆè‡ªç›¸å…³ï¼‰

### `stability_of_timeseries(returns)`
è®¡ç®—æ—¶é—´åºåˆ—çš„ç¨³å®šæ€§ï¼ˆRÂ²ï¼‰

---

## è¿ç»­æ¶¨è·Œç»Ÿè®¡

### è¿ç»­å¤©æ•°/å‘¨æ•°/æœˆæ•°

#### `max_consecutive_up_days(returns)` â­æ–°å¢
è®¡ç®—æœ€å¤§è¿æ¶¨å¤©æ•°

#### `max_consecutive_down_days(returns)` â­æ–°å¢
è®¡ç®—æœ€å¤§è¿è·Œå¤©æ•°

#### `max_consecutive_up_weeks(returns)` â­æ–°å¢
è®¡ç®—æœ€å¤§è¿æ¶¨å‘¨æ•°

#### `max_consecutive_down_weeks(returns)` â­æ–°å¢
è®¡ç®—æœ€å¤§è¿è·Œå‘¨æ•°

#### `max_consecutive_up_months(returns)` â­æ–°å¢
è®¡ç®—æœ€å¤§è¿æ¶¨æœˆæ•°

#### `max_consecutive_down_months(returns)` â­æ–°å¢
è®¡ç®—æœ€å¤§è¿è·Œæœˆæ•°

### æ¶¨è·Œå¹…åº¦

#### `max_consecutive_gain(returns)` â­æ–°å¢
è®¡ç®—æœ€å¤§è¿ç»­æ¶¨å¹…

#### `max_consecutive_loss(returns)` â­æ–°å¢
è®¡ç®—æœ€å¤§è¿ç»­è·Œå¹…

#### `max_single_day_gain(returns)` â­æ–°å¢
è®¡ç®—æœ€å¤§å•æ—¥æ¶¨å¹…

#### `max_single_day_loss(returns)` â­æ–°å¢
è®¡ç®—æœ€å¤§å•æ—¥è·Œå¹…

### æ—¥æœŸä¿¡æ¯

#### `max_consecutive_up_start_date(returns)` â­æ–°å¢
è·å–æœ€å¤§è¿æ¶¨åŒºé—´å¼€å§‹æ—¥æœŸ

#### `max_consecutive_up_end_date(returns)` â­æ–°å¢
è·å–æœ€å¤§è¿æ¶¨åŒºé—´ç»“æŸæ—¥æœŸ

#### `max_consecutive_down_start_date(returns)` â­æ–°å¢
è·å–æœ€å¤§è¿è·ŒåŒºé—´å¼€å§‹æ—¥æœŸ

#### `max_consecutive_down_end_date(returns)` â­æ–°å¢
è·å–æœ€å¤§è¿è·ŒåŒºé—´ç»“æŸæ—¥æœŸ

#### `max_single_day_gain_date(returns)` â­æ–°å¢
è·å–æœ€å¤§å•æ—¥æ¶¨å¹…æ—¥æœŸ

#### `max_single_day_loss_date(returns)` â­æ–°å¢
è·å–æœ€å¤§å•æ—¥è·Œå¹…æ—¥æœŸ

---

## å¹´åº¦æŒ‡æ ‡

### `annual_alpha(returns, factor_returns, risk_free=0.0)` â­æ–°å¢
è®¡ç®—æ¯å¹´çš„Alpha

### `annual_beta(returns, factor_returns, risk_free=0.0)` â­æ–°å¢
è®¡ç®—æ¯å¹´çš„Beta

---

## å¸‚åœºå…³ç³»

### `alpha(returns, factor_returns, risk_free=0.0, period=DAILY, annualization=None)`
è®¡ç®—Alphaï¼ˆJensen's Alphaï¼‰

### `beta(returns, factor_returns, risk_free=0.0)`
è®¡ç®—Beta

### `alpha_beta(returns, factor_returns, risk_free=0.0, period=DAILY, annualization=None)`
åŒæ—¶è®¡ç®—Alphaå’ŒBeta

### `up_capture(returns, factor_returns, period=DAILY, annualization=None)`
è®¡ç®—ä¸Šè¡Œæ•è·ç‡

### `down_capture(returns, factor_returns, period=DAILY, annualization=None)`
è®¡ç®—ä¸‹è¡Œæ•è·ç‡

### `up_down_capture(returns, factor_returns, period=DAILY, annualization=None)`
åŒæ—¶è®¡ç®—ä¸Šè¡Œå’Œä¸‹è¡Œæ•è·ç‡

### `capture(returns, factor_returns, period=DAILY, annualization=None)`
è®¡ç®—æ•è·ç‡

---

## ç›ˆäºç»Ÿè®¡

### `win_rate(returns)`
è®¡ç®—ç›ˆåˆ©å¤©æ•°å æ¯”

### `loss_rate(returns)`
è®¡ç®—äºæŸå¤©æ•°å æ¯”

---

## æ»šåŠ¨æŒ‡æ ‡

å¤§å¤šæ•°æŒ‡æ ‡éƒ½æœ‰å¯¹åº”çš„æ»šåŠ¨ç‰ˆæœ¬ï¼Œä½¿ç”¨ `roll_` å‰ç¼€ï¼š

- `roll_sharpe_ratio()`
- `roll_sortino_ratio()`
- `roll_max_drawdown()`
- `roll_annual_volatility()`
- `roll_alpha()` / `roll_beta()`
- `roll_up_capture()` / `roll_down_capture()`
- `roll_tracking_error()`
- `roll_treynor_ratio()`
- `roll_m_squared()`
- `roll_annual_active_risk()`
- `roll_annual_active_return()`
- ç­‰ç­‰...

---

## ğŸ” ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ç”¨æ³•

```python
import empyrical
import pandas as pd

# å‡†å¤‡æ•°æ®
returns = pd.Series([0.01, 0.02, -0.01, 0.03, -0.02])
benchmark = pd.Series([0.008, 0.018, -0.008, 0.025, -0.015])

# è®¡ç®—å„ç§æŒ‡æ ‡
sharpe = empyrical.sharpe_ratio(returns)
sortino = empyrical.sortino_ratio(returns)
max_dd = empyrical.max_drawdown(returns)
alpha = empyrical.alpha(returns, benchmark)
beta = empyrical.beta(returns, benchmark)
```

### é«˜çº§ç”¨æ³•

```python
# å¹´åº¦æŒ‡æ ‡
annual_sharpe = empyrical.sharpe_ratio_by_year(returns)
annual_alpha = empyrical.annual_alpha(returns, benchmark)
annual_beta = empyrical.annual_beta(returns, benchmark)

# è¿ç»­æ¶¨è·Œåˆ†æ
max_up_days = empyrical.max_consecutive_up_days(returns)
max_gain = empyrical.max_consecutive_gain(returns)
gain_date = empyrical.max_single_day_gain_date(returns)

# ç»Ÿè®¡ç‰¹æ€§
skew = empyrical.skewness(returns)
kurt = empyrical.kurtosis(returns)
hurst = empyrical.hurst_exponent(returns)

# ç›¸å…³æ€§åˆ†æ
stock_corr = empyrical.stock_market_correlation(returns, stock_index)
serial_corr = empyrical.serial_correlation(returns, lag=1)

# é«˜çº§é£é™©æŒ‡æ ‡
sterling = empyrical.sterling_ratio(returns)
burke = empyrical.burke_ratio(returns)
kappa3 = empyrical.kappa_three_ratio(returns)
adj_sharpe = empyrical.adjusted_sharpe_ratio(returns)
stutzer = empyrical.stutzer_index(returns)
residual = empyrical.residual_risk(returns, benchmark)
```

---

## ğŸ“š å‚æ•°è¯´æ˜

### å¸¸ç”¨å‚æ•°

- `returns`: ç­–ç•¥æ”¶ç›Šåºåˆ—ï¼ˆéç´¯è®¡ï¼‰
- `factor_returns`: åŸºå‡†/å¸‚åœºæ”¶ç›Šåºåˆ—ï¼ˆéç´¯è®¡ï¼‰
- `risk_free`: æ— é£é™©æ”¶ç›Šç‡ï¼ˆé»˜è®¤0.0ï¼‰
- `period`: æ”¶ç›Šå‘¨æœŸï¼ˆDAILY, WEEKLY, MONTHLYç­‰ï¼‰
- `annualization`: å¹´åŒ–å› å­ï¼ˆå¯é€‰ï¼Œä¼šè¦†ç›–periodï¼‰
- `required_return`: æœ€å°å¯æ¥å—æ”¶ç›Šï¼ˆç”¨äºSortinoç­‰ï¼‰
- `cutoff`: åˆ†ä½æ•°æˆªæ–­ç‚¹ï¼ˆç”¨äºVaR/CVaRï¼‰

### è¿”å›å€¼ç±»å‹

- å•ä¸€æŒ‡æ ‡ï¼š`float`
- å¹´åº¦æŒ‡æ ‡ï¼š`pd.Series` (å¹´ä»½ä¸ºç´¢å¼•)
- æ—¥æœŸå‡½æ•°ï¼š`pd.Timestamp` æˆ– `None`
- å¤©æ•°/å‘¨æ•°/æœˆæ•°ï¼š`int` æˆ– `np.nan`

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®æ ¼å¼**
   - æ”¶ç›Šåº”è¯¥æ˜¯éç´¯è®¡æ”¶ç›Šï¼ˆsimple returnsï¼‰
   - æ”¯æŒ `pd.Series` å’Œ `np.ndarray` è¾“å…¥
   - æ—¥æœŸç´¢å¼•å¯¹æŸäº›å‡½æ•°æ˜¯å¿…éœ€çš„

2. **è¾¹ç•Œæƒ…å†µ**
   - ç©ºæ•°æ®é€šå¸¸è¿”å› `np.nan`
   - æ•°æ®ä¸è¶³æ—¶ä¼šè¿”å› `np.nan`
   - æŸäº›å‡½æ•°æœ‰æœ€å°æ•°æ®é‡è¦æ±‚

3. **æ€§èƒ½è€ƒè™‘**
   - æ»šåŠ¨æŒ‡æ ‡è®¡ç®—é‡è¾ƒå¤§
   - é•¿æ—¶é—´åºåˆ—å»ºè®®ä½¿ç”¨ä¼˜åŒ–çš„ç®—æ³•
   - HurstæŒ‡æ•°å’ŒStutzeræŒ‡æ•°è®¡ç®—è¾ƒæ…¢

4. **ä¾èµ–é¡¹**
   - numpy >= 1.17.0
   - pandas >= 0.25.0
   - scipy >= 1.3.0
   - six >= 1.10

---

## ğŸ“– æ›´å¤šä¿¡æ¯

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/quantopian/empyrical
- **æ–‡æ¡£**: https://empyrical.ml4trading.io/
- **é—®é¢˜åé¦ˆ**: GitHub Issues
- **è´¡çŒ®æŒ‡å—**: CONTRIBUTING.md

---

**ç´¢å¼•ç‰ˆæœ¬ï¼š** v1.0  
**æœ€åæ›´æ–°ï¼š** 2025-01-11  
**ç»´æŠ¤è€…ï¼š** Empyrical Contributors
