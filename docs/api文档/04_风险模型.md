# 风险模型 API

`fincore.risk` 提供超越标准 VaR/波动率的高级风险建模工具。

## 模块导入

```python
from fincore.risk import (
    # EVT
    hill_estimator, gev_fit, gpd_fit, evt_var, evt_cvar, extreme_risk,
    # GARCH
    GARCH, EGARCH, GJRGARCH, forecast_volatility, conditional_var,
)
```

## 极值理论 (EVT)

### `hill_estimator(returns, threshold=None)`

Hill 尾部指数估计器。

- **returns**: `pd.Series` — 收益率序列
- **threshold**: `float`, 可选 — 阈值百分位数
- **返回**: `float` — 尾部指数

### `gev_fit(returns)`

拟合广义极值分布 (GEV)。

- **返回**: `dict` — 包含 `shape`, `loc`, `scale` 参数

### `gpd_fit(returns, threshold=None)`

拟合广义帕累托分布 (GPD) 到尾部损失。

- **返回**: `dict` — 包含 `shape`, `scale`, `threshold` 参数

### `evt_var(returns, alpha=0.05)`

基于 EVT 的 Value at Risk。

- **alpha**: `float` — 显著性水平（默认 5%）
- **返回**: `float` — VaR 值

### `evt_cvar(returns, alpha=0.05)`

基于 EVT 的 Conditional VaR (Expected Shortfall)。

- **返回**: `float` — CVaR 值

### `extreme_risk(returns)`

综合极端风险报告。

- **返回**: `dict` — 包含 Hill 指数、GPD 参数、EVT-VaR、EVT-CVaR 等

## GARCH 模型

### `GARCH(returns, p=1, q=1)`

标准 GARCH(p,q) 条件波动率模型。

**属性**:

| 属性 | 类型 | 说明 |
|------|------|------|
| `params` | dict | 模型参数 (omega, alpha, beta) |
| `conditional_volatility` | pd.Series | 条件波动率序列 |
| `residuals` | pd.Series | 标准化残差 |

### `EGARCH(returns, p=1, q=1)`

指数 GARCH，捕获杠杆效应（负收益导致更高波动）。

### `GJRGARCH(returns, p=1, q=1)`

GJR-GARCH (Glosten-Jagannathan-Runkle)，另一种非对称 GARCH。

### `forecast_volatility(returns, horizon=1)`

基于 GARCH 的波动率预测。

- **horizon**: `int` — 预测步数
- **返回**: `float` 或 `np.ndarray`

### `conditional_var(returns, alpha=0.05)`

基于 GARCH 条件波动率的 VaR。

- **返回**: `float`

## 使用示例

```python
from fincore.risk import GARCH, evt_var, evt_cvar

# GARCH 波动率建模
garch = GARCH(returns)
print(garch.conditional_volatility.tail())

# EVT 尾部风险
print(f"EVT VaR(99%): {evt_var(returns, alpha=0.01):.4f}")
print(f"EVT CVaR(99%): {evt_cvar(returns, alpha=0.01):.4f}")
```
