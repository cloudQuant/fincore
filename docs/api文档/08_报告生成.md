# 报告生成 API

`fincore.report` 提供 HTML 和 PDF 策略分析报告生成。

## 模块导入

```python
from fincore.report import create_strategy_report
# 或
import fincore
fincore.create_strategy_report(...)
```

## `create_strategy_report(returns, **kwargs)`

生成完整策略分析报告，根据输入数据的丰富程度自动调整报告内容。

**参数**:

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `returns` | `pd.Series` | 必需 | 日收益率序列 |
| `positions` | `pd.DataFrame` | None | 每日持仓市值 |
| `transactions` | `pd.DataFrame` | None | 交易记录 |
| `trades` | `pd.DataFrame` | None | 已平仓交易记录 |
| `title` | `str` | "Strategy Report" | 报告标题 |
| `output` | `str` | "report.html" | 输出路径（.html 或 .pdf） |
| `benchmark_rets` | `pd.Series` | None | 基准收益率 |

**返回**: `str` — 生成的报告文件路径

### 报告内容（根据输入动态调整）

| 输入 | 报告内容 |
|------|---------|
| 仅 returns | 收益分析、风险指标、累计收益图、月度热力图、回撤分析 |
| + positions | 增加持仓分析、暴露度图、杠杆分析 |
| + transactions | 增加交易分析、换手率、交易量 |
| + trades | 增加交易统计（胜率、盈亏比、PnL 分布） |

### HTML 输出

生成自包含的 HTML 文件，内嵌 CSS 和图表：

```python
fincore.create_strategy_report(
    returns,
    title="My Strategy",
    output="report.html",
)
```

### PDF 输出

将 HTML 渲染为 PDF（需要 weasyprint 或类似依赖）：

```python
fincore.create_strategy_report(
    returns,
    title="My Strategy",
    output="report.pdf",
)
```

## 内部模块

### `fincore.report.compute`

计算报告所需的各项指标和统计数据。

### `fincore.report.format`

格式化指标为人类可读的字符串。

### `fincore.report.render_html`

HTML 模板渲染，生成自包含的 HTML 报告。

### `fincore.report.render_pdf`

PDF 渲染引擎，将 HTML 转换为 PDF。

## 使用示例

```python
import fincore

# 1. 最简报告（仅收益率）
fincore.create_strategy_report(
    returns,
    title="Quick Report",
    output="quick.html",
)

# 2. 完整报告
fincore.create_strategy_report(
    returns,
    positions=positions,
    transactions=transactions,
    trades=closed_trades,
    title="Full Analysis Report",
    output="full_report.html",
)

# 3. PDF 报告
fincore.create_strategy_report(
    returns,
    title="PDF Report",
    output="report.pdf",
)
```
